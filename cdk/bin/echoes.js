#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("source-map-support/register");
const cdk = require("aws-cdk-lib");
const echoes_storage_stack_1 = require("../lib/echoes-storage-stack");
const echoes_auth_stack_1 = require("../lib/echoes-auth-stack");
const echoes_api_stack_1 = require("../lib/echoes-api-stack");
const echoes_notif_stack_1 = require("../lib/echoes-notif-stack");
const frontend_stack_1 = require("../lib/frontend-stack");
const network_stack_1 = require("../lib/network-stack");
const frontend_config_construct_1 = require("../lib/frontend-config-construct");
const app = new cdk.App();
// Get environment configuration
const environment = app.node.tryGetContext('environment') || 'dev';
const account = app.node.tryGetContext('account') || process.env.CDK_DEFAULT_ACCOUNT;
const region = app.node.tryGetContext('region') || process.env.CDK_DEFAULT_REGION || 'us-east-1';
const env = { account, region };
// Stack naming convention
const stackPrefix = `Echoes-${environment}`;
// Storage stack (S3 + DynamoDB)
const storageStack = new echoes_storage_stack_1.EchoesStorageStack(app, `${stackPrefix}-Storage`, {
    env,
    description: `Echoes storage resources for ${environment} environment`,
    environment,
});
// Authentication stack (Cognito)
const authStack = new echoes_auth_stack_1.EchoesAuthStack(app, `${stackPrefix}-Auth`, {
    env,
    description: `Echoes authentication resources for ${environment} environment`,
    environment,
});
// API stack (Lambda + API Gateway)
const apiStack = new echoes_api_stack_1.EchoesApiStack(app, `${stackPrefix}-Api`, {
    env,
    description: `Echoes API resources for ${environment} environment`,
    environment,
    bucket: storageStack.audioBucket,
    table: storageStack.echoesTable,
    userPool: authStack.userPool,
    userPoolClient: authStack.userPoolClient,
});
// Notifications stack (EventBridge + SNS)
const notifStack = new echoes_notif_stack_1.EchoesNotifStack(app, `${stackPrefix}-Notif`, {
    env,
    description: `Echoes notification resources for ${environment} environment`,
    environment,
    table: storageStack.echoesTable,
});
// Frontend stack (S3 static hosting)
const frontendStack = new frontend_stack_1.EchoesFrontendStack(app, `${stackPrefix}-Frontend`, {
    env,
    description: `Echoes frontend hosting resources for ${environment} environment`,
    environment,
});
// Network stack (CloudFront CDN)
const networkStack = new network_stack_1.EchoesNetworkStack(app, `${stackPrefix}-Network`, {
    env,
    description: `Echoes network resources for ${environment} environment`,
    environment,
    frontendBucket: frontendStack.websiteBucket,
    originAccessIdentity: frontendStack.originAccessIdentity,
    // Optional: Add custom domain if available
    // domainName: 'echoes.app',
});
// Create a separate stack for frontend configuration to avoid circular dependencies
const frontendConfigStack = new cdk.Stack(app, `${stackPrefix}-Config`, {
    env,
    description: `Echoes frontend configuration for ${environment} environment`,
});
// Frontend configuration - aggregates all outputs for frontend environment
const frontendConfig = new frontend_config_construct_1.FrontendConfig(frontendConfigStack, 'FrontendConfig', {
    environment,
    apiUrl: apiStack.apiUrl,
    cognitoUserPoolId: authStack.userPool.userPoolId,
    cognitoClientId: authStack.userPoolClient.userPoolClientId,
    s3BucketName: storageStack.audioBucket.bucketName,
    cloudFrontUrl: networkStack.distribution.distributionDomainName,
    region: region,
});
// Add dependencies
apiStack.addDependency(storageStack);
apiStack.addDependency(authStack);
notifStack.addDependency(storageStack);
networkStack.addDependency(frontendStack);
// Frontend config depends on all stacks it references
frontendConfigStack.addDependency(apiStack);
frontendConfigStack.addDependency(authStack);
frontendConfigStack.addDependency(storageStack);
frontendConfigStack.addDependency(networkStack);
// Add tags to all stacks
const tags = {
    Project: 'Echoes',
    Environment: environment,
    ManagedBy: 'CDK',
};
Object.values(tags).forEach(([key, value]) => {
    cdk.Tags.of(app).add(key, value);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWNob2VzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZWNob2VzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLHVDQUFxQztBQUNyQyxtQ0FBbUM7QUFDbkMsc0VBQWlFO0FBQ2pFLGdFQUEyRDtBQUMzRCw4REFBeUQ7QUFDekQsa0VBQTZEO0FBQzdELDBEQUE0RDtBQUM1RCx3REFBMEQ7QUFDMUQsZ0ZBQWtFO0FBRWxFLE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBRTFCLGdDQUFnQztBQUNoQyxNQUFNLFdBQVcsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsSUFBSSxLQUFLLENBQUM7QUFDbkUsTUFBTSxPQUFPLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQztBQUNyRixNQUFNLE1BQU0sR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsSUFBSSxPQUFPLENBQUMsR0FBRyxDQUFDLGtCQUFrQixJQUFJLFdBQVcsQ0FBQztBQUVqRyxNQUFNLEdBQUcsR0FBRyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsQ0FBQztBQUVoQywwQkFBMEI7QUFDMUIsTUFBTSxXQUFXLEdBQUcsVUFBVSxXQUFXLEVBQUUsQ0FBQztBQUU1QyxnQ0FBZ0M7QUFDaEMsTUFBTSxZQUFZLEdBQUcsSUFBSSx5Q0FBa0IsQ0FBQyxHQUFHLEVBQUUsR0FBRyxXQUFXLFVBQVUsRUFBRTtJQUN6RSxHQUFHO0lBQ0gsV0FBVyxFQUFFLGdDQUFnQyxXQUFXLGNBQWM7SUFDdEUsV0FBVztDQUNaLENBQUMsQ0FBQztBQUVILGlDQUFpQztBQUNqQyxNQUFNLFNBQVMsR0FBRyxJQUFJLG1DQUFlLENBQUMsR0FBRyxFQUFFLEdBQUcsV0FBVyxPQUFPLEVBQUU7SUFDaEUs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RUFBRSxXQUFXO0lBQ3hCLFNBQVMsRUFBRSxLQUFLO0NBQ2pCLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUU7SUFDM0MsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNuQyxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIiMhL3Vzci9iaW4vZW52IG5vZGVcbmltcG9ydCAnc291cmNlLW1hcC1zdXBwb3J0L3JlZ2lzdGVyJztcbmltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgeyBFY2hvZXNTdG9yYWdlU3RhY2sgfSBmcm9tICcuLi9saWIvZWNob2VzLXN0b3JhZ2Utc3RhY2snO1xuaW1wb3J0IHsgRWNob2VzQXV0aFN0YWNrIH0gZnJvbSAnLi4vbGliL2VjaG9lcy1hdXRoLXN0YWNrJztcbmltcG9ydCB7IEVjaG9lc0FwaVN0YWNrIH0gZnJvbSAnLi4vbGliL2VjaG9lcy1hcGktc3RhY2snO1xuaW1wb3J0IHsgRWNob2VzTm90aWZTdGFjayB9IGZyb20gJy4uL2xpYi9lY2hvZXMtbm90aWYtc3RhY2snO1xuaW1wb3J0IHsgRWNob2VzRnJvbnRlbmRTdGFjayB9IGZyb20gJy4uL2xpYi9mcm9udGVuZC1zdGFjayc7XG5pbXBvcnQgeyBFY2hvZXNOZXR3b3JrU3RhY2sgfSBmcm9tICcuLi9saWIvbmV0d29yay1zdGFjayc7XG5pbXBvcnQgeyBGcm9udGVuZENvbmZpZyB9IGZyb20gJy4uL2xpYi9mcm9udGVuZC1jb25maWctY29uc3RydWN0JztcblxuY29uc3QgYXBwID0gbmV3IGNkay5BcHAoKTtcblxuLy8gR2V0IGVudmlyb25tZW50IGNvbmZpZ3VyYXRpb25cbmNvbnN0IGVudmlyb25tZW50ID0gYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnZW52aXJvbm1lbnQnKSB8fCAnZGV2JztcbmNvbnN0IGFjY291bnQgPSBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdhY2NvdW50JykgfHwgcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfQUNDT1VOVDtcbmNvbnN0IHJlZ2lvbiA9IGFwcC5ub2RlLnRyeUdldENvbnRleHQoJ3JlZ2lvbicpIHx8IHByb2Nlc3MuZW52LkNES19ERUZBVUxUX1JFR0lPTiB8fCAndXMtZWFzdC0xJztcblxuY29uc3QgZW52ID0geyBhY2NvdW50LCByZWdpb24gfTtcblxuLy8gU3RhY2sgbmFtaW5nIGNvbnZlbnRpb25cbmNvbnN0IHN0YWNrUHJlZml4ID0gYEVjaG9lcy0ke2Vudmlyb25tZW50fWA7XG5cbi8vIFN0b3JhZ2Ugc3RhY2sgKFMzICsgRHluYW1vREIpXG5jb25zdCBzdG9yYWdlU3RhY2sgPSBuZXcgRWNob2VzU3RvcmFnZVN0YWNrKGFwcCwgYCR7c3RhY2tQcmVmaXh9LVN0b3JhZ2VgLCB7XG4gIGVudixcbiAgZGVzY3JpcHRpb246IGBFY2hvZXMgc3RvcmFnZSByZXNvdXJjZXMgZm9yICR7ZW52aXJvbm1lbnR9IGVudmlyb25tZW50YCxcbiAgZW52aXJvbm1lbnQsXG59KTtcblxuLy8gQXV0aGVudGljYXRpb24gc3RhY2sgKENvZ25pdG8pXG5jb25zdCBhdXRoU3RhY2sgPSBuZXcgRWNob2VzQXV0aFN0YWNrKGFwcCwgYCR7c3RhY2tQcmVmaXh9LUF1dGhgLCB7XG4gIGVudixcbiAgZGVzY3JpcHRpb246IGBFY2hvZXMgYXV0aGVudGljYXRpb24gcmVzb3VyY2VzIGZvciAke2Vudmlyb25tZW50fSBlbnZpcm9ubWVudGAsXG4gIGVudmlyb25tZW50LFxufSk7XG5cbi8vIEFQSSBzdGFjayAoTGFtYmRhICsgQVBJIEdhdGV3YXkpXG5jb25zdCBhcGlTdGFjayA9IG5ldyBFY2hvZXNBcGlTdGFjayhhcHAsIGAke3N0YWNrUHJlZml4fS1BcGlgLCB7XG4gIGVudixcbiAgZGVzY3JpcHRpb246IGBFY2hvZXMgQVBJIHJlc291cmNlcyBmb3IgJHtlbnZpcm9ubWVudH0gZW52aXJvbm1lbnRgLFxuICBlbnZpcm9ubWVudCxcbiAgYnVja2V0OiBzdG9yYWdlU3RhY2suYXVkaW9CdWNrZXQsXG4gIHRhYmxlOiBzdG9yYWdlU3RhY2suZWNob2VzVGFibGUsXG4gIHVzZXJQb29sOiBhdXRoU3RhY2sudXNlclBvb2wsXG4gIHVzZXJQb29sQ2xpZW50OiBhdXRoU3RhY2sudXNlclBvb2xDbGllbnQsXG59KTtcblxuLy8gTm90aWZpY2F0aW9ucyBzdGFjayAoRXZlbnRCcmlkZ2UgKyBTTlMpXG5jb25zdCBub3RpZlN0YWNrID0gbmV3IEVjaG9lc05vdGlmU3RhY2soYXBwLCBgJHtzdGFja1ByZWZpeH0tTm90aWZgLCB7XG4gIGVudixcbiAgZGVzY3JpcHRpb246IGBFY2hvZXMgbm90aWZpY2F0aW9uIHJlc291cmNlcyBmb3IgJHtlbnZpcm9ubWVudH0gZW52aXJvbm1lbnRgLFxuICBlbnZpcm9ubWVudCxcbiAgdGFibGU6IHN0b3JhZ2VTdGFjay5lY2hvZXNUYWJsZSxcbn0pO1xuXG4vLyBGcm9udGVuZCBzdGFjayAoUzMgc3RhdGljIGhvc3RpbmcpXG5jb25zdCBmcm9udGVuZFN0YWNrID0gbmV3IEVjaG9lc0Zyb250ZW5kU3RhY2soYXBwLCBgJHtzdGFja1ByZWZpeH0tRnJvbnRlbmRgLCB7XG4gIGVudixcbiAgZGVzY3JpcHRpb246IGBFY2hvZXMgZnJvbnRlbmQgaG9zdGluZyByZXNvdXJjZXMgZm9yICR7ZW52aXJvbm1lbnR9IGVudmlyb25tZW50YCxcbiAgZW52aXJvbm1lbnQsXG59KTtcblxuLy8gTmV0d29yayBzdGFjayAoQ2xvdWRGcm9udCBDRE4pXG5jb25zdCBuZXR3b3JrU3RhY2sgPSBuZXcgRWNob2VzTmV0d29ya1N0YWNrKGFwcCwgYCR7c3RhY2tQcmVmaXh9LU5ldHdvcmtgLCB7XG4gIGVudixcbiAgZGVzY3JpcHRpb246IGBFY2hvZXMgbmV0d29yayByZXNvdXJjZXMgZm9yICR7ZW52aXJvbm1lbnR9IGVudmlyb25tZW50YCxcbiAgZW52aXJvbm1lbnQsXG4gIGZyb250ZW5kQnVja2V0OiBmcm9udGVuZFN0YWNrLndlYnNpdGVCdWNrZXQsXG4gIG9yaWdpbkFjY2Vzc0lkZW50aXR5OiBmcm9udGVuZFN0YWNrLm9yaWdpbkFjY2Vzc0lkZW50aXR5LFxuICAvLyBPcHRpb25hbDogQWRkIGN1c3RvbSBkb21haW4gaWYgYXZhaWxhYmxlXG4gIC8vIGRvbWFpbk5hbWU6ICdlY2hvZXMuYXBwJyxcbn0pO1xuXG4vLyBDcmVhdGUgYSBzZXBhcmF0ZSBzdGFjayBmb3IgZnJvbnRlbmQgY29uZmlndXJhdGlvbiB0byBhdm9pZCBjaXJjdWxhciBkZXBlbmRlbmNpZXNcbmNvbnN0IGZyb250ZW5kQ29uZmlnU3RhY2sgPSBuZXcgY2RrLlN0YWNrKGFwcCwgYCR7c3RhY2tQcmVmaXh9LUNvbmZpZ2AsIHtcbiAgZW52LFxuICBkZXNjcmlwdGlvbjogYEVjaG9lcyBmcm9udGVuZCBjb25maWd1cmF0aW9uIGZvciAke2Vudmlyb25tZW50fSBlbnZpcm9ubWVudGAsXG59KTtcblxuLy8gRnJvbnRlbmQgY29uZmlndXJhdGlvbiAtIGFnZ3JlZ2F0ZXMgYWxsIG91dHB1dHMgZm9yIGZyb250ZW5kIGVudmlyb25tZW50XG5jb25zdCBmcm9udGVuZENvbmZpZyA9IG5ldyBGcm9udGVuZENvbmZpZyhmcm9udGVuZENvbmZpZ1N0YWNrLCAnRnJvbnRlbmRDb25maWcnLCB7XG4gIGVudmlyb25tZW50LFxuICBhcGlVcmw6IGFwaVN0YWNrLmFwaVVybCxcbiAgY29nbml0b1VzZXJQb29sSWQ6IGF1dGhTdGFjay51c2VyUG9vbC51c2VyUG9vbElkLFxuICBjb2duaXRvQ2xpZW50SWQ6IGF1dGhTdGFjay51c2VyUG9vbENsaWVudC51c2VyUG9vbENsaWVudElkLFxuICBzM0J1Y2tldE5hbWU6IHN0b3JhZ2VTdGFjay5hdWRpb0J1Y2tldC5idWNrZXROYW1lLFxuICBjbG91ZEZyb250VXJsOiBuZXR3b3JrU3RhY2suZGlzdHJpYnV0aW9uLmRpc3RyaWJ1dGlvbkRvbWFpbk5hbWUsXG4gIHJlZ2lvbjogcmVnaW9uLFxufSk7XG5cbi8vIEFkZCBkZXBlbmRlbmNpZXNcbmFwaVN0YWNrLmFkZERlcGVuZGVuY3koc3RvcmFnZVN0YWNrKTtcbmFwaVN0YWNrLmFkZERlcGVuZGVuY3koYXV0aFN0YWNrKTtcbm5vdGlmU3RhY2suYWRkRGVwZW5kZW5jeShzdG9yYWdlU3RhY2spO1xubmV0d29ya1N0YWNrLmFkZERlcGVuZGVuY3koZnJvbnRlbmRTdGFjayk7XG4vLyBGcm9udGVuZCBjb25maWcgZGVwZW5kcyBvbiBhbGwgc3RhY2tzIGl0IHJlZmVyZW5jZXNcbmZyb250ZW5kQ29uZmlnU3RhY2suYWRkRGVwZW5kZW5jeShhcGlTdGFjayk7XG5mcm9udGVuZENvbmZpZ1N0YWNrLmFkZERlcGVuZGVuY3koYXV0aFN0YWNrKTtcbmZyb250ZW5kQ29uZmlnU3RhY2suYWRkRGVwZW5kZW5jeShzdG9yYWdlU3RhY2spO1xuZnJvbnRlbmRDb25maWdTdGFjay5hZGREZXBlbmRlbmN5KG5ldHdvcmtTdGFjayk7XG5cbi8vIEFkZCB0YWdzIHRvIGFsbCBzdGFja3NcbmNvbnN0IHRhZ3MgPSB7XG4gIFByb2plY3Q6ICdFY2hvZXMnLFxuICBFbnZpcm9ubWVudDogZW52aXJvbm1lbnQsXG4gIE1hbmFnZWRCeTogJ0NESycsXG59O1xuXG5PYmplY3QudmFsdWVzKHRhZ3MpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICBjZGsuVGFncy5vZihhcHApLmFkZChrZXksIHZhbHVlKTtcbn0pOyJdfQ==